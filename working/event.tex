%
%
\subsection{Event}
%
Event Projector : $\pi_i : \eventset \to \mathcal{VAR} \cup \mathbb{N} \cup \mathcal{VAL} \cup \mathcal{QVAL}$
\[
\begin{array}{lll}
\pi_1((x, l, n, v)) \triangleq x
&
\pi_1 (x, l, n, \qval, v) \triangleq x
&
\pi_1 (b, l, n, v)  \triangleq x
\\
\pi_2((x, l, n, v)) \triangleq l
&
\pi_2 (x, l, n, \qval, v) \triangleq l
&
\pi_2 (b, l, n, v)  \triangleq l
\\
\pi_3((x, l, n, v)) \triangleq n
&
\pi_3 (x, l, n, \qval, v) \triangleq n
&
\pi_3 (b, l, n, v)  \triangleq n
\\
\pi_4((x, l, n, v)) \triangleq v
&
\pi_4 (x, l, n, \qval, v) \triangleq \qval
&
\pi_4 (b, l, n, v)  \triangleq v
\\
\pi_5((x, l, n, v)) \triangleq \bot
&
\pi_5 (x, l, n, \qval, v) \triangleq v
&
\pi_5 (b, l, n, v)  \triangleq \bot
\end{array}
\]
%
Event Value : $\pi_v : \eventset \to \mathcal{VAL}$
\[
\begin{array}{lll}
\pi_v((x, l, n, v)) \triangleq v
&
\pi_v (x, l, n, \qval, v) \triangleq v
&
\pi_v (b, l, n, v)  \triangleq v
\end{array}
\]
%
%
Event Distinguishable Value : $\pi_{q} : \eventset \to \mathcal{QVAL}$ 
\[
\begin{array}{lll}
\pi_{q} (x, l, n, v) \triangleq v
&
\pi_{q} (x, l, n, \qval, v) \triangleq \qval
&
\pi_{q} (b, l, n, v)  \triangleq v
\end{array}
\]%
% 
Event Signature : $\pi_{\sig} : \eventset \to \mathcal{SIG}$
\[
\begin{array}{lll}
\pi_{\sig} (x, l, n, v) \triangleq (x, l, n)
&
\pi_{\sig} (x, l, n, \qval, v) \triangleq (x, l, n, \query)
&
\pi_{\sig} (b, l, n, v)  \triangleq (b, l, n)
\end{array}
\]

%
\begin{defn}[Equivalence of Query Expression].
%
\label{def:query_equal}
Given a trace $\trace$ and 2 query expressions $\qexpr_1$, $\qexpr_2$:
$$
\qexpr_1 =_{q}^{\trace} \qexpr_2 \triangleq
\left\{
  \begin{array}{ll} 
    \etrue      
    & 
  \exists \qval_1, \qval_2 \in \mathcal{QVAL} \st
  \begin{array}{l} 
    (\config{\trace,  \qexpr_1} \qarrow \qval_1 \land \config{\trace,  \qexpr_2 } \qarrow \qval_2) 
    \\
    \land (\forall D \in \dbdom, r \in D \st 
    \exists v \in \mathcal{VAL} \st 
          \config{\trace, \qval_1[r/\chi]} \aarrow v \land \config{\trace,  \qval_2[r/\chi] } \aarrow v)  
  \end{array}\\
    \efalse         
    & \text{o.w.} 
  \end{array}
  \right.
$$
%
, where $r \in D$ is a record in the database domain $D$, $FV(\qexpr)$ is the set of free variables in the query expression $\qexpr$.
$\qexpr_1 \neq_{q}^{\trace} \qexpr_2$  is defined vice versa.
%
We use $=_{q}$  and $\neq_{q}$ as the shorthands when $\trace$ is empty.
\end{defn}
%
\begin{defn}[Event Equivalence $\eventeq$]
Two events $\event_1, \event_2 \in \eventset$ is in \emph{Equivalence} relation, denoted as $\event_1 \eventeq \event_2$ if and only if:
\[
\pi_{\sig}(\event_1) = \pi_{\sig}(\event_2) 
\land
\pi_{q}(\event_1) = \pi_{q}(\event_2)
\land
\pi_{v}(\event_1) = \pi_{v}(\event_2)
\]
%
The $\event_1 \eventneq \event_2$ is defined as vice versa.
\end{defn}
%
%
\todo{
\begin{defn}[Event Isomorphic $\ismeq$]
Two events $\event_1, \event_2 \in \eventset$ is \emph{Isomorphic}, denoted as $\event_1 \ismeq \event_2$ if and only if:
\[
\pi_{\sig}(\event_1) = \pi_{\sig}(\event_2) 
\]
The $\event_1 \ismneq \event_2$ is defined as vice versa.
\end{defn}
%
\begin{defn}[Event Isomorphically Different $\ismdiff$]
Two events $\event_1, \event_2 \in \eventset$ is \emph{Isomorphically Different}, 
denoted as $\ismdiff(\event_1, \event_2)$ if and only if:
\[
\pi_{\sig}(\event_1) = \pi_{\sig}(\event_2) 
\land 
\pi_{q}(\event_1) \neq \pi_{q}(\event_2)
\]
\end{defn}
}
%
\begin{defn}[Order of Events].
\label{def:query_dir}
\\
An event $\event_1 \in \eventset$, where $\pi_{\sig}(\event_1) = (x_1, l_1, n_1)$,
has smaller order than another event $\event_2 \in \eventset$, 
where 
$ \pi_{\sig}(\event_2) = (x_2, l_2, n_2)$, defined as follows:
%
\[
\event_1 \eventlt \event_2
\triangleq 
\left\{
\begin{array}{ll}
  l_1 < l_2 & n_1 = n_2
  \\
  n_1 < n_2  & o.w.
\end{array}  
\right.
\]
%
$\event_1 \eventgeq \event_2$  is defined vice versa.
\end{defn}
%
%