%
%
\subsection{Event}
%
Event Value : $\pi_v : \eventset \to \mathcal{VAL}$
\[
\begin{array}{ll}
\pi_v((x, l, n, v)) \triangleq v
&
\pi_v (x, l, n, \qval, v) \triangleq v
\\
\pi_v (b, l, n, v)  \triangleq v
&
\end{array}
\]
%
Event Query Value : $\pi_{q} : \eventset \to \mathcal{QVAL}$
\[
\begin{array}{ll}
\pi_{q} (x, l, n, v) \triangleq v
&
\pi_{q} (x, l, n, \qval, v) \triangleq \qval
\\
\pi_{q} (b, l, n, v)  \triangleq v
&
\end{array}
\]%
% 
Event Signature : $\pi_{\sig} : \eventset \to \mathcal{SIG}$
\[
\begin{array}{ll}
\pi_{\sig} (x, l, n, v) \triangleq (x, l, n)
&
\pi_{\sig} (x, l, n, \qval, v) \triangleq (x, l, n, \query)
\\
\pi_{\sig} (b, l, n, v)  \triangleq (b, l, n)
&
\end{array}
\]
%
%
\begin{defn}[Equivalence of Query].
%
\label{def:query_equal}
Given a trace $\trace$ and 2 query expressions $\qexpr_1$, $\qexpr_2$:
$$
\qexpr_1 =_{q}^{\trace} \qexpr_2 \triangleq
\left\{
    \begin{array}{ll} 
      \etrue      
      & 
    \exists \qval_1, \qval_2.
    \begin{array}{l} 
      (\config{\trace,  \qexpr_1} \qarrow \qval_1 \land \config{\trace,  \qexpr_2 } \qarrow \qval_2) 
      \\
      \land (\forall D \in \dbdom, r \in D. \exists v. ~ s.t., ~ 
            \config{\trace, \qval_1[r/\chi]} \aarrow v \land \config{\trace,  \qval_2[r/\chi] } \aarrow v)  
    \end{array}\\
      \efalse         
      & \text{o.w.} 
    \end{array}
    \right.
$$
%
, where $r \in D$ is a record in the database domain $D$, $FV(\qexpr)$ is the set of free variables in the query expression $\qexpr$.
$\qexpr_1 \neq_{q}^{\trace} \qexpr_2$  is defined vice versa.
%
We use $=_{q}$  and $\neq_{q}$ as the shorthands when $\trace$ is empty.
\end{defn}
%
Equivalence of 2 events : $\event_1 \eventeq \event_2$
\[
\event_1 \eventeq \event_2 \triangleq
\left\{
\begin{array}{ll}
\etrue & \event_1 = (x, l, n, v) \land \event_2 = (x, l, n, v) \\
\etrue & \event_1 = (x, l, n, \qval_1, v) \land \event_2 = (x, l, n, \qval_2, v)  
\land \qval_1 =_{q} \qval_2\\
\etrue & \event_1 = (b, l, n, v) \land \event_2 = (b, l, n, v) \\
\efalse & o.w.
\end{array}
\right.
\]
%
Signature Equivalence of 2 events : $\event_1 \sigeq \event_2$
\[
\event_1 \sigeq \event_2 \triangleq
\left\{
\begin{array}{ll}
\etrue & \event_1 = (x, l, n, v) \land \event_2 = (x, l, n, v') \\
\etrue & \event_1 = (x, l, n, \qval, v) \land \event_2 = (x, l, n, \qval', v') \\
\etrue & \event_1 = (b, l, n, v) \land \event_2 = (b, l, n, v') \\
\efalse & o.w.
\end{array}
\right.
\]
%
\begin{defn}[Order of Events].
\label{def:query_dir}
\\
Given 2 events 
$\event_1 = (x_1, l_1, n_1), 
\event_2 = (x_2, l_2, n_2)$
:
%
\[
\event_1 \eventlt \event_2
 \triangleq 
 \left\{
 \begin{array}{ll}
    l_1 < l_2 & n_1 = n_2
    \\
    n_1 < n_2  & o.w.
\end{array}  
\right.
\]
%
$\event_1 \eventgeq \event_2$  is defined vice versa.
\end{defn}
%
%