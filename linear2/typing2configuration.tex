\begin{proof}
  By induction on the typing derivation.\\

  \caseL{
    Case $
      \inferrule{
    }{
      \ictx \tctx , x: \bang{1} \type \tvdash{0} x: \type
    }~\textbf{Ax}
    $
  }

  let $(\valr, \env', R) \in \lrv{\bang{1} \type}$ and $(\valr_i, \env_i, R_i) \in \lrv{\Gamma(x_i)}$,   TS:
  $\tvdash{0 + 1\times R} ( x,   [x \to (\valr, \env', R)] \uplus [ x_i \to (\valr_i, \env_i, R_i)]   ) $.

  let $\env =  [x \to (\valr, \env', R)] \uplus [ x_i \to (\valr_i, \env_i, R_i)]   $. 
  We conclude from the configuratio rule C-Ax.
  
  \[ \inferrule{
     \env ( x ) = (\valr, \env', R)
      \\
      \tvdash{0} ( \valr, \env') : \type
    }{
     \tvdash{R}   ( x, \env):  \type
    }~\textbf{C-Ax}
  \]

  \caseL{
    Case $
       \inferrule{
      \ictx \Gamma, x: \ltype
      \tvdash{\nnatA }
      \expr: \type
    }{
      \ictx \Gamma \tvdash{0} \lambda x. \expr : \ltype
      \lto{\nnatA} \type
    }~\textbf{lambda}
    $
  }

  let $\Gamma = x_i : \bang{k_i} \type_i$ and  $\ltype = \bang{k} \type_1$.

  Assume $(\valr', \env', R') \in \lrv{ \bang{k} \type_1}~(1)$ and $ (\valr_i, \env_i, R_i) \in \lrv{\bang{k_i} \type_i } $.

  TS: $ \tvdash{0 + k_1 \times R_1 + , \ldots, +  k_i \times R_i   }   (\lambda x.\expr,  [x_1 \to (\valr_1, \env_1, R_1), \ldots,   x_i \to (\valr_i, \env_i, R_i)] ) $.

  Let $S = k_1 \times R_1 + , \ldots, +  k_i \times R_i  $ and $ \env =  [x_1 \to (\valr_1, \env_1, R_1), \ldots,   x_i \to (\valr_i, \env_i, R_i)]  $.

  From assumption $(1)$, we know :  $\tvdash{\_} ( \valr', \theta') : \type_1~(\star)$.

  Take a fresh variable x', doing alpha renaming on the premise,then by induction hypothesis on the premise , we know: $\tvdash{ \nnatA+ k_1 \times R_1 + , \ldots, +  k_i \times R_i + k \times R' }   ( \expr[x'/x],  [x' \to (\valr', \env', R')] \uplus \env  ) ~(\diamond) $.

 We can conclude the following by the configuration rule. 
    
  
  \[
       \inferrule{
      \tvdash{\_} ( \valr', \theta') : \type_1 ~(\star)
      \\
      \fresh\eapp  x'
      \\
      \tvdash{ S+  \idx \times R' +\nnatA }
     ( \expr[x'/x], \env[x' \to (\valr', \theta', R')]      ) :
     \type_2~(\diamond)
    }{
     \tvdash{S} (  \lambda x. \expr, \env )  : \bang{\idx} \type_1
      \lto{\nnatA} \type_2
    }~\textbf{C-lambda}
  \]


  \caseL{Case
    $
        \inferrule{
      \ictx \Gamma_1  \tvdash{\nnatA_1} \expr_1:  \bang{\idx} \type_1
      \lto{\nnatA} \type_2      \\
      \ictx \Gamma_2 \tvdash{\nnatA_2} \expr_2: \type_1 
    }{
      \ictx   \Gamma_1 + \idx \times \Gamma_2  \tvdash{    \nnatA_1 +
        \idx \times \nnatA_2 + \nnatA    } \expr_1 \eapp \expr_2 : \type_2
    }~\textbf{app}
    $
  }
  
  Let us assume $\Gamma_1 = x_i : \bang{k_i} \type_i $ and $\Gamma_2 = x_i' : \bang{k_i'} \type_i'$,($\Gamma_1$ and $\Gamma_2$ may overleap.).

  forall the variables $x_i''$ in $\dom{\Gamma_1 + k \times \Gamma_2 }$, we assume: $(\valr_i'', \env'', R'') \in \lrv{ (\Gamma_1 + k \times \Gamma_2)(x_i'')  }$ and $ (\Gamma_1 + k \times \Gamma_2 )(x_i'') = \bang{k_i''} \type_i'' $.

  TS: $ \tvdash{\nnatA_1+ k \times \nnatA_2 + \nnatA + k_1'' \times R_i'' +, \ldots ,+ k_i'' \times R_i''  }   (\expr_1 \eapp \expr_2 ,  [x_1'' \to (\valr_1'', \env_1'', R_1''), \ldots,   x_i'' \to (\valr_i'', \env_i'', R_i'')]   ) $.

  let $\env_1 = \{  [x_i'' \to (\valr_i'', \env_i'', R_i'') ]   |     x_i'' \in \dom(\Gamma_1)  \}   $.

  let $\env_2 = \{  [x_i'' \to (\valr_i'', \env_i'', R_i'') ]   |     x_i'' \in \dom(\Gamma_2)  \}   $.

  By induction hypothesis on the first premise, we have:
  $ \tvdash{ \nnatA_1 + k_i'' \times R_i'' } (\expr_1, \env_1) : \bang{\idx} \type_1 \lto{\nnatA} \type_2 ~(\star)$ where $x_i'' \in dom(\Gamma_1) $.

  By induction hypothesis on the second premise, we have:
  $ \tvdash{ \nnatA_2 + k_i'' \times R_i'' } (\expr_2, \env_2) : \type_1 $ where $x_i'' \in dom(\Gamma_2)~(\diamond) $.

  
  
  

  

  
  \[
 \inferrule{
       \tvdash{\nnatA_1} ( \expr_1, \env_1) :  \bang{\idx} \type_1
      \lto{\nnatA} \type_2    ~(\star)  \\
      \tvdash{\nnatA_2} ( \expr_2, \env_2 ): \type_1 ~(\diamond)
      \\
        \Gamma \vDash \env
      \\
      \Gamma \tvdash{  \nnatA_1 +\idx \times \nnatA_2 + \nnatA  }  \expr_1 \eapp \expr_2 : \type_2
    }{
       \tvdash{    \nnatA_1 +\idx \times \nnatA_2 + \nnatA    } (  \expr_1 \eapp \expr_2, \env_1 \uplus \env_2   ) : \type_2
    }~\textbf{C-app}
  \]
  
  
  
 \end{proof} 
